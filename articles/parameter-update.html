<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Parameter Update Functions • meow</title>
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="parameter-update_files/libs/quarto-html/popper.min.js"></script><script src="parameter-update_files/libs/quarto-html/tippy.umd.min.js"></script><link href="parameter-update_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="parameter-update_files/libs/quarto-html/light-border.css" rel="stylesheet">
<!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Parameter Update Functions">
<meta property="og:image" content="http://klintkanopka.com/meow/logo.png">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">meow</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/data-loaders.html">Data Loaders</a></li>
    <li><a class="dropdown-item" href="../articles/item-selection.html">Item Selection Functions</a></li>
    <li><a class="dropdown-item" href="../articles/parameter-update.html">Parameter Update Functions</a></li>
    <li><a class="dropdown-item" href="../articles/meow-viz.html">Visualizing with `meow`: Comparing Item Exposure Control Methods</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/index.html">More articles...</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/klintkanopka/meow/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-quarto">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Parameter Update Functions</h1>




      <small class="dont-index">Source: <a href="https://github.com/klintkanopka/meow/blob/main/vignettes/parameter-update.qmd" class="external-link"><code>vignettes/parameter-update.qmd</code></a></small>
      <div class="d-none name"><code></code></div>
    </div>






    <p>Parameter update functions are the core estimation component of the <code>meow</code> framework. These functions take the current parameter estimates and response data, then update the person and item parameters based on the chosen estimation algorithm. The quality and efficiency of these functions directly impact the accuracy of the adaptive testing system.</p>
<p>In this vignette, we will explore the available parameter update functions and learn how to implement custom estimation algorithms.</p>
<section class="section level2"><h2 id="understanding-parameter-update-functions">Understanding Parameter Update Functions<a class="anchor" aria-label="anchor" href="#understanding-parameter-update-functions"></a>
</h2>
<p>Parameter update functions in <code>meow</code> receive the current state of estimated parameters and response data, then return updated estimates. They are responsible for:</p>
<ul>
<li>Updating person ability estimates (<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>)</li>
<li>Updating item difficulty estimates (<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>b</mi><annotation encoding="application/x-tex">b</annotation></semantics></math>)</li>
<li>Updating item discrimination estimates (<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>a</mi><annotation encoding="application/x-tex">a</annotation></semantics></math>) if using 2PL or 3PL models</li>
<li>Returning the updated response set</li>
</ul>
<section class="level2"><h3 id="function-signature">Function Signature<a class="anchor" aria-label="anchor" href="#function-signature"></a>
</h3>
<p>All parameter update functions must follow this signature:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">update_function</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span></span>
<span>  <span class="va">pers</span>,           <span class="co"># Current person parameter estimates</span></span>
<span>  <span class="va">item</span>,           <span class="co"># Current item parameter estimates</span></span>
<span>  <span class="va">resp</span>,           <span class="co"># Response data to use for estimation</span></span>
<span>  <span class="va">...</span>             <span class="co"># Additional arguments</span></span>
<span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Function implementation</span></span>
<span>  </span>
<span>  <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    pers_est <span class="op">=</span> <span class="va">updated_pers</span>,</span>
<span>    item_est <span class="op">=</span> <span class="va">updated_item</span>,</span>
<span>    resp_cur <span class="op">=</span> <span class="va">resp</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</section><section class="level2"><h3 id="return-values">Return Values<a class="anchor" aria-label="anchor" href="#return-values"></a>
</h3>
<p>Parameter update functions must return a list with three components:</p>
<ol type="1">
<li>
<strong><code>pers_est</code></strong>: Updated person parameter estimates (dataframe with <code>id</code> column and parameter columns)</li>
<li>
<strong><code>item_est</code></strong>: Updated item parameter estimates (dataframe with <code>item</code> column and parameter columns)</li>
<li>
<strong><code>resp_cur</code></strong>: The response data used for estimation (typically the same as input <code>resp</code>)</li>
</ol></section></section><section class="section level2"><h2 id="available-parameter-update-functions">Available Parameter Update Functions<a class="anchor" aria-label="anchor" href="#available-parameter-update-functions"></a>
</h2>
<section class="level2"><h3 id="maximum-likelihood-estimation-mle">Maximum Likelihood Estimation (MLE)<a class="anchor" aria-label="anchor" href="#maximum-likelihood-estimation-mle"></a>
</h3>
<p>The <code><a href="../reference/update_theta_mle.html">update_theta_mle()</a></code> function updates person abilities using maximum likelihood estimation while treating item parameters as fixed:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">update_theta_mle</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">pers</span>, <span class="va">item</span>, <span class="va">resp</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Unidimensional 2PL MLE estimation of ability, treating item params as fixed</span></span>
<span>  <span class="va">theta_mle</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">pers</span>, <span class="va">item</span>, <span class="va">resp</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">loglik</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">theta</span>, <span class="va">item</span>, <span class="va">resp</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span></span>
<span>        <span class="va">item</span><span class="op">$</span><span class="va">a</span><span class="op">[</span><span class="va">resp</span><span class="op">$</span><span class="va">item</span><span class="op">]</span> <span class="op">*</span> <span class="op">(</span><span class="va">theta</span><span class="op">[</span><span class="va">resp</span><span class="op">$</span><span class="va">id</span><span class="op">]</span> <span class="op">-</span> <span class="va">item</span><span class="op">$</span><span class="va">b</span><span class="op">[</span><span class="va">resp</span><span class="op">$</span><span class="va">item</span><span class="op">]</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>      <span class="va">ll</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">resp</span><span class="op">$</span><span class="va">resp</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">resp</span><span class="op">$</span><span class="va">resp</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">p</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">ll</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span></span>
<span>    <span class="va">est</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></span><span class="op">(</span></span>
<span>      <span class="va">pers</span><span class="op">$</span><span class="va">theta</span>,</span>
<span>      <span class="va">loglik</span>,</span>
<span>      lower <span class="op">=</span> <span class="op">-</span><span class="fl">4</span>,</span>
<span>      upper <span class="op">=</span> <span class="fl">4</span>,</span>
<span>      item <span class="op">=</span> <span class="va">item</span>,</span>
<span>      resp <span class="op">=</span> <span class="va">resp</span>,</span>
<span>      method <span class="op">=</span> <span class="st">'L-BFGS-B'</span>,</span>
<span>      control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fnscale <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">est</span><span class="op">$</span><span class="va">par</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="va">pers</span><span class="op">$</span><span class="va">theta</span> <span class="op">&lt;-</span> <span class="fu">theta_mle</span><span class="op">(</span><span class="va">pers</span>, <span class="va">item</span>, <span class="va">resp</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    pers_est <span class="op">=</span> <span class="va">pers</span>,</span>
<span>    item_est <span class="op">=</span> <span class="va">item</span>,</span>
<span>    resp_cur <span class="op">=</span> <span class="va">resp</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>This function: 1. Defines a log-likelihood function for the 2PL model 2. Uses <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">stats::optim()</a></code> with L-BFGS-B method to maximize the likelihood 3. Constrains ability estimates to the range [-4, 4] 4. Only updates person abilities, leaving item parameters unchanged 5. Returns the updated person estimates and unchanged item estimates</p>
</section><section class="level2"><h3 id="maths-garden-update">Maths Garden Update<a class="anchor" aria-label="anchor" href="#maths-garden-update"></a>
</h3>
<p>The <code><a href="../reference/update_maths_garden.html">update_maths_garden()</a></code> function implements the update rule from the Maths Garden paper:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">update_maths_garden</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">theta</span>, <span class="va">diff</span>, <span class="va">resp</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Implement the update rule from the maths garden paper</span></span>
<span>  <span class="co"># Theta_hat_j = theta_j + K_j (S_ij - E(S_ij))</span></span>
<span>  <span class="co"># Beta_hat_i = beta_i + K_i(E(S_ij)-S_ij)</span></span>
<span>  <span class="co"># where S_ij is the observed score and E(S_ij) is the expected probability</span></span>
<span></span>
<span>  <span class="co"># Calculate expected probabilities using logistic function</span></span>
<span>  <span class="va">E_Sij</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="va">theta</span><span class="op">[</span><span class="va">resp</span><span class="op">$</span><span class="va">id</span><span class="op">]</span> <span class="op">-</span> <span class="va">diff</span><span class="op">[</span><span class="va">resp</span><span class="op">$</span><span class="va">item</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Learning rates (K values) - these could be tuned</span></span>
<span>  <span class="va">K_theta</span> <span class="op">&lt;-</span> <span class="fl">0.1</span> <span class="co"># Learning rate for ability</span></span>
<span>  <span class="va">K_beta</span> <span class="op">&lt;-</span> <span class="fl">0.1</span>  <span class="co"># Learning rate for difficulty</span></span>
<span></span>
<span>  <span class="co"># Update theta (ability) for each person</span></span>
<span>  <span class="va">theta_updated</span> <span class="op">&lt;-</span> <span class="va">theta</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">resp</span><span class="op">$</span><span class="va">id</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># Get responses for person j</span></span>
<span>    <span class="va">resp_j</span> <span class="op">&lt;-</span> <span class="va">resp</span><span class="op">[</span><span class="va">resp</span><span class="op">$</span><span class="va">id</span> <span class="op">==</span> <span class="va">j</span>, <span class="op">]</span></span>
<span>    <span class="co"># Calculate update term</span></span>
<span>    <span class="va">update_term</span> <span class="op">&lt;-</span> <span class="va">K_theta</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">resp_j</span><span class="op">$</span><span class="va">resp</span> <span class="op">-</span> <span class="va">E_Sij</span><span class="op">[</span><span class="va">resp</span><span class="op">$</span><span class="va">id</span> <span class="op">==</span> <span class="va">j</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">theta_updated</span><span class="op">[</span><span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">theta</span><span class="op">[</span><span class="va">j</span><span class="op">]</span> <span class="op">+</span> <span class="va">update_term</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="co"># Update beta (difficulty) for each item</span></span>
<span>  <span class="va">beta_updated</span> <span class="op">&lt;-</span> <span class="va">diff</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">resp</span><span class="op">$</span><span class="va">item</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># Get responses for item i</span></span>
<span>    <span class="va">resp_i</span> <span class="op">&lt;-</span> <span class="va">resp</span><span class="op">[</span><span class="va">resp</span><span class="op">$</span><span class="va">item</span> <span class="op">==</span> <span class="va">i</span>, <span class="op">]</span></span>
<span>    <span class="co"># Calculate update term</span></span>
<span>    <span class="va">update_term</span> <span class="op">&lt;-</span> <span class="va">K_beta</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">E_Sij</span><span class="op">[</span><span class="va">resp</span><span class="op">$</span><span class="va">item</span> <span class="op">==</span> <span class="va">i</span><span class="op">]</span> <span class="op">-</span> <span class="va">resp_i</span><span class="op">$</span><span class="va">resp</span><span class="op">)</span></span>
<span>    <span class="va">beta_updated</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">diff</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="va">update_term</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    theta_est <span class="op">=</span> <span class="va">theta_updated</span>,</span>
<span>    diff_est <span class="op">=</span> <span class="va">beta_updated</span>,</span>
<span>    resp_cur <span class="op">=</span> <span class="va">resp</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>This function implements a simple gradient-based update rule: 1. Calculates expected response probabilities using the logistic function 2. Updates person abilities: <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>θ</mi><mi>j</mi><mrow><mi>n</mi><mi>e</mi><mi>w</mi></mrow></msubsup><mo>=</mo><msub><mi>θ</mi><mi>j</mi></msub><mo>+</mo><msub><mi>K</mi><mi>θ</mi></msub><msub><mo>∑</mo><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>S</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>−</mo><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>S</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\theta_j^{new} = \theta_j + K_\theta \sum_i (S_{ij} - E(S_{ij}))</annotation></semantics></math> 3. Updates item difficulties: <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>b</mi><mi>i</mi><mrow><mi>n</mi><mi>e</mi><mi>w</mi></mrow></msubsup><mo>=</mo><msub><mi>b</mi><mi>i</mi></msub><mo>+</mo><msub><mi>K</mi><mi>b</mi></msub><msub><mo>∑</mo><mi>j</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>S</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><msub><mi>S</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">b_i^{new} = b_i + K_b \sum_j (E(S_{ij}) - S_{ij})</annotation></semantics></math> 4. Uses fixed learning rates that can be tuned</p>
</section><section class="level2"><h3 id="prowise-learn-update">Prowise Learn Update<a class="anchor" aria-label="anchor" href="#prowise-learn-update"></a>
</h3>
<p>The <code><a href="../reference/update_prowise_learn.html">update_prowise_learn()</a></code> function implements the Prowise Learn algorithm with paired item updates:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">update_prowise_learn</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">theta</span>, <span class="va">diff</span>, <span class="va">resp</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Implement the update rule from the Prowise Learn paper with paired item updates</span></span>
<span>  <span class="co"># to prevent rating drift</span></span>
<span></span>
<span>  <span class="co"># Initialize updated parameters</span></span>
<span>  <span class="va">theta_updated</span> <span class="op">&lt;-</span> <span class="va">theta</span></span>
<span>  <span class="va">diff_updated</span> <span class="op">&lt;-</span> <span class="va">diff</span></span>
<span></span>
<span>  <span class="co"># Learning rates (K values) - these could be tuned</span></span>
<span>  <span class="va">K_theta</span> <span class="op">&lt;-</span> <span class="fl">0.1</span> <span class="co"># Learning rate for ability</span></span>
<span>  <span class="va">K_beta</span> <span class="op">&lt;-</span> <span class="fl">0.1</span>  <span class="co"># Learning rate for difficulty</span></span>
<span></span>
<span>  <span class="co"># Calculate expected probabilities for all responses</span></span>
<span>  <span class="va">E_Sij</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="va">theta</span><span class="op">[</span><span class="va">resp</span><span class="op">$</span><span class="va">id</span><span class="op">]</span> <span class="op">-</span> <span class="va">diff</span><span class="op">[</span><span class="va">resp</span><span class="op">$</span><span class="va">item</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Update theta (ability) for each person</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">resp</span><span class="op">$</span><span class="va">id</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">resp_j</span> <span class="op">&lt;-</span> <span class="va">resp</span><span class="op">[</span><span class="va">resp</span><span class="op">$</span><span class="va">id</span> <span class="op">==</span> <span class="va">j</span>, <span class="op">]</span></span>
<span>    <span class="va">update_term</span> <span class="op">&lt;-</span> <span class="va">K_theta</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">resp_j</span><span class="op">$</span><span class="va">resp</span> <span class="op">-</span> <span class="va">E_Sij</span><span class="op">[</span><span class="va">resp</span><span class="op">$</span><span class="va">id</span> <span class="op">==</span> <span class="va">j</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">theta_updated</span><span class="op">[</span><span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">theta</span><span class="op">[</span><span class="va">j</span><span class="op">]</span> <span class="op">+</span> <span class="va">update_term</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="co"># Paired item updates</span></span>
<span>  <span class="va">update_count</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">person</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">resp</span><span class="op">$</span><span class="va">id</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">person_idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">resp</span><span class="op">$</span><span class="va">id</span> <span class="op">==</span> <span class="va">person</span><span class="op">)</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">person_idx</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">person_idx</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">idx_now</span> <span class="op">&lt;-</span> <span class="va">person_idx</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span>        <span class="va">idx_prev</span> <span class="op">&lt;-</span> <span class="va">person_idx</span><span class="op">[</span><span class="va">i</span> <span class="op">-</span> <span class="fl">1</span><span class="op">]</span></span>
<span>        <span class="va">item_now</span> <span class="op">&lt;-</span> <span class="va">resp</span><span class="op">$</span><span class="va">item</span><span class="op">[</span><span class="va">idx_now</span><span class="op">]</span></span>
<span>        <span class="va">item_prev</span> <span class="op">&lt;-</span> <span class="va">resp</span><span class="op">$</span><span class="va">item</span><span class="op">[</span><span class="va">idx_prev</span><span class="op">]</span></span>
<span>        <span class="va">s_now</span> <span class="op">&lt;-</span> <span class="va">resp</span><span class="op">$</span><span class="va">resp</span><span class="op">[</span><span class="va">idx_now</span><span class="op">]</span></span>
<span>        <span class="va">s_prev</span> <span class="op">&lt;-</span> <span class="va">resp</span><span class="op">$</span><span class="va">resp</span><span class="op">[</span><span class="va">idx_prev</span><span class="op">]</span></span>
<span>        <span class="va">e_now</span> <span class="op">&lt;-</span> <span class="va">E_Sij</span><span class="op">[</span><span class="va">idx_now</span><span class="op">]</span></span>
<span>        <span class="va">e_prev</span> <span class="op">&lt;-</span> <span class="va">E_Sij</span><span class="op">[</span><span class="va">idx_prev</span><span class="op">]</span></span>
<span>        <span class="va">kappa</span> <span class="op">&lt;-</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="op">(</span><span class="va">K_beta</span> <span class="op">*</span> <span class="op">(</span><span class="va">s_now</span> <span class="op">-</span> <span class="va">e_now</span><span class="op">)</span> <span class="op">-</span> <span class="va">K_beta</span> <span class="op">*</span> <span class="op">(</span><span class="va">s_prev</span> <span class="op">-</span> <span class="va">e_prev</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="va">diff_updated</span><span class="op">[</span><span class="va">item_now</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">diff_updated</span><span class="op">[</span><span class="va">item_now</span><span class="op">]</span> <span class="op">+</span> <span class="va">kappa</span></span>
<span>        <span class="va">diff_updated</span><span class="op">[</span><span class="va">item_prev</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">diff_updated</span><span class="op">[</span><span class="va">item_prev</span><span class="op">]</span> <span class="op">-</span> <span class="va">kappa</span></span>
<span>        <span class="va">update_count</span> <span class="op">&lt;-</span> <span class="va">update_count</span> <span class="op">+</span> <span class="fl">1</span></span>
<span>      <span class="op">}</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Prowise item updates triggered:"</span>, <span class="va">update_count</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    theta_est <span class="op">=</span> <span class="va">theta_updated</span>,</span>
<span>    diff_est <span class="op">=</span> <span class="va">diff_updated</span>,</span>
<span>    resp_cur <span class="op">=</span> <span class="va">resp</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>This function: 1. Updates person abilities using the same rule as Maths Garden 2. Implements paired item updates to prevent rating drift 3. For each person with multiple responses, updates pairs of consecutive items 4. Uses the update rule: <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>κ</mi><mo>=</mo><mn>0.5</mn><mo>⋅</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>K</mi><mi>b</mi></msub><mo>⋅</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>S</mi><mrow><mi>n</mi><mi>o</mi><mi>w</mi></mrow></msub><mo>−</mo><msub><mi>E</mi><mrow><mi>n</mi><mi>o</mi><mi>w</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><msub><mi>K</mi><mi>b</mi></msub><mo>⋅</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>S</mi><mrow><mi>p</mi><mi>r</mi><mi>e</mi><mi>v</mi></mrow></msub><mo>−</mo><msub><mi>E</mi><mrow><mi>p</mi><mi>r</mi><mi>e</mi><mi>v</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\kappa = 0.5 \cdot (K_b \cdot (S_{now} - E_{now}) - K_b \cdot (S_{prev} - E_{prev}))</annotation></semantics></math> 5. Applies <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>κ</mi><annotation encoding="application/x-tex">\kappa</annotation></semantics></math> to the current item and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>−</mi><mi>κ</mi></mrow><annotation encoding="application/x-tex">-\kappa</annotation></semantics></math> to the previous item</p>
</section></section><section class="section level2"><h2 id="best-practices">Best Practices<a class="anchor" aria-label="anchor" href="#best-practices"></a>
</h2>
<ol type="1">
<li>
<strong>Return proper format</strong>: Always return a list with <code>pers_est</code>, <code>item_est</code>, and <code>resp_cur</code>
</li>
<li>
<strong>Handle edge cases</strong>: Consider what happens with few responses or extreme parameter values</li>
<li>
<strong>Parameter constraints</strong>: Implement reasonable bounds on parameter estimates (e.g., [-4, 4] for abilities)</li>
<li>
<strong>Numerical stability</strong>: Use log-space calculations when appropriate to avoid numerical underflow</li>
<li>
<strong>Convergence</strong>: Consider implementing convergence checks for iterative methods</li>
<li>
<strong>Documentation</strong>: Clearly document the mathematical basis and assumptions of your algorithm</li>
<li>
<strong>Testing</strong>: Test your function with various scenarios before using in simulations</li>
</ol></section><section class="section level2"><h2 id="using-custom-functions">Using Custom Functions<a class="anchor" aria-label="anchor" href="#using-custom-functions"></a>
</h2>
<p>To use a custom parameter update function in a simulation:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define your custom function</span></span>
<span><span class="va">my_update_function</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">pers</span>, <span class="va">item</span>, <span class="va">resp</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Your implementation here</span></span>
<span>  <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    pers_est <span class="op">=</span> <span class="va">updated_pers</span>,</span>
<span>    item_est <span class="op">=</span> <span class="va">updated_item</span>,</span>
<span>    resp_cur <span class="op">=</span> <span class="va">resp</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Use it in simulation</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/meow.html">meow</a></span><span class="op">(</span></span>
<span>  select_fun <span class="op">=</span> <span class="va">select_max_info</span>,</span>
<span>  update_fun <span class="op">=</span> <span class="va">my_update_function</span>,</span>
<span>  data_loader <span class="op">=</span> <span class="va">data_simple_1pl</span>,</span>
<span>  update_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>custom_param <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>  data_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>N_persons <span class="op">=</span> <span class="fl">100</span>, N_items <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</section><section class="section level2"><h2 id="mathematical-background">Mathematical Background<a class="anchor" aria-label="anchor" href="#mathematical-background"></a>
</h2>
<section class="level2"><h3 id="maximum-likelihood-estimation">Maximum Likelihood Estimation<a class="anchor" aria-label="anchor" href="#maximum-likelihood-estimation"></a>
</h3>
<p>For the 2PL model, the likelihood function is:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><munderover><mo>∏</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mi>P</mi><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false" form="prefix">|</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>x</mi><mi>i</mi></msub></msup><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false" form="prefix">|</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mn>1</mn><mo>−</mo><msub><mi>x</mi><mi>i</mi></msub></mrow></msup></mrow><annotation encoding="application/x-tex">L(\theta) = \prod_{i=1}^{n} P(x_i|\theta)^{x_i} (1-P(x_i|\theta))^{1-x_i}</annotation></semantics></math></p>
<p>where <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false" form="prefix">|</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow><mi>−</mi><msub><mi>a</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo>−</mo><msub><mi>b</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msup></mrow></mfrac></mrow><annotation encoding="application/x-tex">P(x_i|\theta) = \frac{1}{1 + e^{-a_i(\theta - b_i)}}</annotation></semantics></math></p>
<p>The log-likelihood is:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>ℓ</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>x</mi><mi>i</mi></msub><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>P</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msub><mi>P</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">\ell(\theta) = \sum_{i=1}^{n} [x_i \log(P_i) + (1-x_i)\log(1-P_i)]</annotation></semantics></math></p>
</section><section class="level2"><h3 id="gradient-based-updates">Gradient-Based Updates<a class="anchor" aria-label="anchor" href="#gradient-based-updates"></a>
</h3>
<p>For gradient-based methods like Maths Garden, the update rule is:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>θ</mi><mrow><mi>n</mi><mi>e</mi><mi>w</mi></mrow></msup><mo>=</mo><msup><mi>θ</mi><mrow><mi>o</mi><mi>l</mi><mi>d</mi></mrow></msup><mo>+</mo><mi>η</mi><munder><mo>∑</mo><mi>i</mi></munder><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><msub><mi>P</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\theta^{new} = \theta^{old} + \eta \sum_i (x_i - P_i)</annotation></semantics></math></p>
<p>where <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>η</mi><annotation encoding="application/x-tex">\eta</annotation></semantics></math> is the learning rate and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>P</mi><mi>i</mi></msub><annotation encoding="application/x-tex">P_i</annotation></semantics></math> is the expected probability of a correct response.</p>
</section></section><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config);
    }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script></main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Klint Kanopka, Sophia Deng.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
