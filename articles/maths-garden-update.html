<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Implementing the Maths Garden Update Algorithm • meow</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="maths-garden-update_files/libs/quarto-html/popper.min.js"></script><script src="maths-garden-update_files/libs/quarto-html/tippy.umd.min.js"></script><link href="maths-garden-update_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="maths-garden-update_files/libs/quarto-html/light-border.css" rel="stylesheet">
<!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Implementing the Maths Garden Update Algorithm">
<meta property="og:image" content="http://klintkanopka.com/meow/logo.png">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">meow</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/meow-viz.html">Visualizing Item Exposure Control Methods</a></li>
    <li><a class="dropdown-item" href="../articles/data-loaders.html">Data Loaders</a></li>
    <li><a class="dropdown-item" href="../articles/item-selection.html">Item Selection Functions</a></li>
    <li><a class="dropdown-item" href="../articles/parameter-update.html">Parameter Update Functions</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/index.html">More articles...</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/klintkanopka/meow/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-quarto">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Implementing the Maths Garden Update Algorithm</h1>




      <small class="dont-index">Source: <a href="https://github.com/klintkanopka/meow/blob/main/vignettes/maths-garden-update.qmd" class="external-link"><code>vignettes/maths-garden-update.qmd</code></a></small>
      <div class="d-none name"><code></code></div>
    </div>






    <p>The Maths Garden update algorithm is a gradient-based parameter estimation method specifically designed for computer adaptive testing systems. This algorithm was developed for the Maths Garden platform, an educational game that adapts mathematical problems to individual student abilities in real-time.</p>
<p>In this vignette, we will explore the mathematical foundations of the Maths Garden algorithm, its implementation in the <code>meow</code> framework, and how to use and customize it for your research.</p>
<section class="section level2"><h2 id="mathematical-foundation">Mathematical Foundation<a class="anchor" aria-label="anchor" href="#mathematical-foundation"></a>
</h2>
<section class="level2"><h3 id="core-update-equations">Core Update Equations<a class="anchor" aria-label="anchor" href="#core-update-equations"></a>
</h3>
<p>The Maths Garden algorithm implements simultaneous updates for both person abilities (<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>) and item difficulties (<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>b</mi><annotation encoding="application/x-tex">b</annotation></semantics></math>) using gradient-based learning. The update equations are:</p>
<p><strong>Person Ability Update:</strong> <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>θ</mi><mi>j</mi><mrow><mi>n</mi><mi>e</mi><mi>w</mi></mrow></msubsup><mo>=</mo><msubsup><mi>θ</mi><mi>j</mi><mrow><mi>o</mi><mi>l</mi><mi>d</mi></mrow></msubsup><mo>+</mo><msub><mi>K</mi><mi>θ</mi></msub><munder><mo>∑</mo><mrow><mi>i</mi><mo>∈</mo><msub><mi>I</mi><mi>j</mi></msub></mrow></munder><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>S</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>−</mo><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>S</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\theta_j^{new} = \theta_j^{old} + K_\theta \sum_{i \in I_j} (S_{ij} - E(S_{ij}))</annotation></semantics></math></p>
<p><strong>Item Difficulty Update:</strong> <math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>b</mi><mi>i</mi><mrow><mi>n</mi><mi>e</mi><mi>w</mi></mrow></msubsup><mo>=</mo><msubsup><mi>b</mi><mi>i</mi><mrow><mi>o</mi><mi>l</mi><mi>d</mi></mrow></msubsup><mo>+</mo><msub><mi>K</mi><mi>b</mi></msub><munder><mo>∑</mo><mrow><mi>j</mi><mo>∈</mo><msub><mi>J</mi><mi>i</mi></msub></mrow></munder><mrow><mo stretchy="true" form="prefix">(</mo><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>S</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><msub><mi>S</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">b_i^{new} = b_i^{old} + K_b \sum_{j \in J_i} (E(S_{ij}) - S_{ij})</annotation></semantics></math></p>
<p>Where: - <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>θ</mi><mi>j</mi></msub><annotation encoding="application/x-tex">\theta_j</annotation></semantics></math> is the ability of person <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math> - <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>b</mi><mi>i</mi></msub><annotation encoding="application/x-tex">b_i</annotation></semantics></math> is the difficulty of item <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math> - <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>S</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">S_{ij}</annotation></semantics></math> is the observed response (0 or 1) of person <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math> to item <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math> - <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>S</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">E(S_{ij})</annotation></semantics></math> is the expected probability of a correct response - <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>K</mi><mi>θ</mi></msub><annotation encoding="application/x-tex">K_\theta</annotation></semantics></math> and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>K</mi><mi>b</mi></msub><annotation encoding="application/x-tex">K_b</annotation></semantics></math> are learning rates for abilities and difficulties respectively - <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>I</mi><mi>j</mi></msub><annotation encoding="application/x-tex">I_j</annotation></semantics></math> is the set of items responded to by person <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math> - <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>J</mi><mi>i</mi></msub><annotation encoding="application/x-tex">J_i</annotation></semantics></math> is the set of persons who responded to item <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math></p>
</section><section class="level2"><h3 id="expected-response-probability">Expected Response Probability<a class="anchor" aria-label="anchor" href="#expected-response-probability"></a>
</h3>
<p>The expected probability <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>S</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">E(S_{ij})</annotation></semantics></math> is calculated using the logistic function:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>S</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>S</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mn>1</mn><mo stretchy="false" form="prefix">|</mo><msub><mi>θ</mi><mi>j</mi></msub><mo>,</mo><msub><mi>b</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow><mi>−</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>θ</mi><mi>j</mi></msub><mo>−</mo><msub><mi>b</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msup></mrow></mfrac></mrow><annotation encoding="application/x-tex">E(S_{ij}) = P(S_{ij} = 1 | \theta_j, b_i) = \frac{1}{1 + e^{-(\theta_j - b_i)}}</annotation></semantics></math></p>
<p>This is the 1-parameter logistic (1PL) item response model, also known as the Rasch model.</p>
</section><section class="level2"><h3 id="intuition-behind-the-updates">Intuition Behind the Updates<a class="anchor" aria-label="anchor" href="#intuition-behind-the-updates"></a>
</h3>
<ol type="1">
<li><p><strong>Person Ability Updates</strong>: If a person performs better than expected (more correct responses than predicted), their ability estimate increases. If they perform worse than expected, their ability estimate decreases.</p></li>
<li><p><strong>Item Difficulty Updates</strong>: If an item is answered correctly more often than expected, its difficulty decreases (becomes easier). If it’s answered correctly less often than expected, its difficulty increases (becomes harder).</p></li>
<li><p><strong>Learning Rates</strong>: The <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>K</mi><annotation encoding="application/x-tex">K</annotation></semantics></math> parameters control how quickly the estimates change. Larger values lead to faster adaptation but may cause instability.</p></li>
</ol></section></section><section class="section level2"><h2 id="implementation-in-meow">Implementation in <code>meow</code>
<a class="anchor" aria-label="anchor" href="#implementation-in-meow"></a>
</h2>
<section class="level2"><h3 id="function-overview">Function Overview<a class="anchor" aria-label="anchor" href="#function-overview"></a>
</h3>
<p>The <code><a href="../reference/update_maths_garden.html">update_maths_garden()</a></code> function implements this algorithm:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">update_maths_garden</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">pers</span>, <span class="va">item</span>, <span class="va">resp</span>, <span class="va">K_theta</span> <span class="op">=</span> <span class="fl">0.1</span>, <span class="va">K_b</span> <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Implement the update rule from the maths garden paper</span></span>
<span>  <span class="co"># Theta_hat_j = theta_j + K_j (S_ij - E(S_ij))</span></span>
<span>  <span class="co"># Beta_hat_i = beta_i + K_i(E(S_ij)-S_ij)</span></span>
<span>  <span class="co"># where S_ij is the observed score and E(S_ij) is the expected probability</span></span>
<span></span>
<span>  <span class="co"># Calculate expected probabilities using logistic function</span></span>
<span>  <span class="va">E_Sij</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="va">pers</span><span class="op">$</span><span class="va">theta</span><span class="op">[</span><span class="va">resp</span><span class="op">$</span><span class="va">id</span><span class="op">]</span> <span class="op">-</span> <span class="va">item</span><span class="op">$</span><span class="va">b</span><span class="op">[</span><span class="va">resp</span><span class="op">$</span><span class="va">item</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Update theta (ability) for each person</span></span>
<span>  <span class="va">theta_updated</span> <span class="op">&lt;-</span> <span class="va">pers</span><span class="op">$</span><span class="va">theta</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">resp</span><span class="op">$</span><span class="va">id</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># Get responses for person j</span></span>
<span>    <span class="va">resp_j</span> <span class="op">&lt;-</span> <span class="va">resp</span><span class="op">[</span><span class="va">resp</span><span class="op">$</span><span class="va">id</span> <span class="op">==</span> <span class="va">j</span>, <span class="op">]</span></span>
<span>    <span class="co"># Calculate update term</span></span>
<span>    <span class="va">update_term</span> <span class="op">&lt;-</span> <span class="va">K_theta</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">resp_j</span><span class="op">$</span><span class="va">resp</span> <span class="op">-</span> <span class="va">E_Sij</span><span class="op">[</span><span class="va">resp</span><span class="op">$</span><span class="va">id</span> <span class="op">==</span> <span class="va">j</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">theta_updated</span><span class="op">[</span><span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">pers</span><span class="op">$</span><span class="va">theta</span><span class="op">[</span><span class="va">j</span><span class="op">]</span> <span class="op">+</span> <span class="va">update_term</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="va">pers</span><span class="op">$</span><span class="va">theta</span> <span class="op">&lt;-</span> <span class="va">theta_updated</span></span>
<span></span>
<span>  <span class="co"># Update beta (difficulty) for each item</span></span>
<span>  <span class="va">b_updated</span> <span class="op">&lt;-</span> <span class="va">item</span><span class="op">$</span><span class="va">b</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">resp</span><span class="op">$</span><span class="va">item</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="co"># Get responses for item i</span></span>
<span>    <span class="va">resp_i</span> <span class="op">&lt;-</span> <span class="va">resp</span><span class="op">[</span><span class="va">resp</span><span class="op">$</span><span class="va">item</span> <span class="op">==</span> <span class="va">i</span>, <span class="op">]</span></span>
<span>    <span class="co"># Calculate update term</span></span>
<span>    <span class="va">update_term</span> <span class="op">&lt;-</span> <span class="va">K_b</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">E_Sij</span><span class="op">[</span><span class="va">resp</span><span class="op">$</span><span class="va">item</span> <span class="op">==</span> <span class="va">i</span><span class="op">]</span> <span class="op">-</span> <span class="va">resp_i</span><span class="op">$</span><span class="va">resp</span><span class="op">)</span></span>
<span>    <span class="va">b_updated</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">item</span><span class="op">$</span><span class="va">b</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="va">update_term</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="va">item</span><span class="op">$</span><span class="va">b</span> <span class="op">&lt;-</span> <span class="va">b_updated</span></span>
<span></span>
<span>  <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    pers <span class="op">=</span> <span class="va">pers</span>,</span>
<span>    item <span class="op">=</span> <span class="va">item</span>,</span>
<span>    resp_cur <span class="op">=</span> <span class="va">resp</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</section><section class="level2"><h3 id="step-by-step-breakdown">Step-by-Step Breakdown<a class="anchor" aria-label="anchor" href="#step-by-step-breakdown"></a>
</h3>
<section class="level3"><h4 id="expected-probability-calculation">1. Expected Probability Calculation<a class="anchor" aria-label="anchor" href="#expected-probability-calculation"></a>
</h4>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">E_Sij</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="va">theta</span><span class="op">[</span><span class="va">resp</span><span class="op">$</span><span class="va">id</span><span class="op">]</span> <span class="op">-</span> <span class="va">diff</span><span class="op">[</span><span class="va">resp</span><span class="op">$</span><span class="va">item</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p>This calculates the expected probability of a correct response for each person-item combination using the logistic function.</p>
</section><section class="level3"><h4 id="person-ability-updates">2. Person Ability Updates<a class="anchor" aria-label="anchor" href="#person-ability-updates"></a>
</h4>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">resp</span><span class="op">$</span><span class="va">id</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">resp_j</span> <span class="op">&lt;-</span> <span class="va">resp</span><span class="op">[</span><span class="va">resp</span><span class="op">$</span><span class="va">id</span> <span class="op">==</span> <span class="va">j</span>, <span class="op">]</span></span>
<span>  <span class="va">update_term</span> <span class="op">&lt;-</span> <span class="va">K_theta</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">resp_j</span><span class="op">$</span><span class="va">resp</span> <span class="op">-</span> <span class="va">E_Sij</span><span class="op">[</span><span class="va">resp</span><span class="op">$</span><span class="va">id</span> <span class="op">==</span> <span class="va">j</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">theta_updated</span><span class="op">[</span><span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">theta</span><span class="op">[</span><span class="va">j</span><span class="op">]</span> <span class="op">+</span> <span class="va">update_term</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>For each person, this: - Collects all responses from that person - Calculates the sum of prediction errors (observed - expected) - Multiplies by the learning rate - Updates the ability estimate</p>
</section><section class="level3"><h4 id="item-difficulty-updates">3. Item Difficulty Updates<a class="anchor" aria-label="anchor" href="#item-difficulty-updates"></a>
</h4>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">resp</span><span class="op">$</span><span class="va">item</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">resp_i</span> <span class="op">&lt;-</span> <span class="va">resp</span><span class="op">[</span><span class="va">resp</span><span class="op">$</span><span class="va">item</span> <span class="op">==</span> <span class="va">i</span>, <span class="op">]</span></span>
<span>  <span class="va">update_term</span> <span class="op">&lt;-</span> <span class="va">K_beta</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">E_Sij</span><span class="op">[</span><span class="va">resp</span><span class="op">$</span><span class="va">item</span> <span class="op">==</span> <span class="va">i</span><span class="op">]</span> <span class="op">-</span> <span class="va">resp_i</span><span class="op">$</span><span class="va">resp</span><span class="op">)</span></span>
<span>  <span class="va">beta_updated</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">diff</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="va">update_term</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>For each item, this: - Collects all responses to that item - Calculates the sum of prediction errors (expected - observed) - Multiplies by the learning rate - Updates the difficulty estimate</p>
</section></section></section><section class="section level2"><h2 id="using-the-maths-garden-algorithm">Using the Maths Garden Algorithm<a class="anchor" aria-label="anchor" href="#using-the-maths-garden-algorithm"></a>
</h2>
<section class="level2"><h3 id="basic-usage">Basic Usage<a class="anchor" aria-label="anchor" href="#basic-usage"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Run simulation with Maths Garden updates</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/meow.html">meow</a></span><span class="op">(</span></span>
<span>  select_fun <span class="op">=</span> <span class="va">select_max_info</span>,</span>
<span>  update_fun <span class="op">=</span> <span class="va">update_maths_garden</span>,</span>
<span>  data_loader <span class="op">=</span> <span class="va">data_simple_1pl</span>,</span>
<span>  data_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>N_persons <span class="op">=</span> <span class="fl">100</span>, N_items <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</section><section class="level2"><h3 id="customizing-learning-rates">Customizing Learning Rates<a class="anchor" aria-label="anchor" href="#customizing-learning-rates"></a>
</h3>
<p>You can modify the learning rates by creating a wrapper function:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">update_maths_garden_custom</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">theta</span>, <span class="va">diff</span>, <span class="va">resp</span>, <span class="va">K_theta</span> <span class="op">=</span> <span class="fl">0.05</span>, <span class="va">K_beta</span> <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Calculate expected probabilities using logistic function</span></span>
<span>  <span class="va">E_Sij</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="va">theta</span><span class="op">[</span><span class="va">resp</span><span class="op">$</span><span class="va">id</span><span class="op">]</span> <span class="op">-</span> <span class="va">diff</span><span class="op">[</span><span class="va">resp</span><span class="op">$</span><span class="va">item</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Update theta (ability) for each person</span></span>
<span>  <span class="va">theta_updated</span> <span class="op">&lt;-</span> <span class="va">theta</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">resp</span><span class="op">$</span><span class="va">id</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">resp_j</span> <span class="op">&lt;-</span> <span class="va">resp</span><span class="op">[</span><span class="va">resp</span><span class="op">$</span><span class="va">id</span> <span class="op">==</span> <span class="va">j</span>, <span class="op">]</span></span>
<span>    <span class="va">update_term</span> <span class="op">&lt;-</span> <span class="va">K_theta</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">resp_j</span><span class="op">$</span><span class="va">resp</span> <span class="op">-</span> <span class="va">E_Sij</span><span class="op">[</span><span class="va">resp</span><span class="op">$</span><span class="va">id</span> <span class="op">==</span> <span class="va">j</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">theta_updated</span><span class="op">[</span><span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">theta</span><span class="op">[</span><span class="va">j</span><span class="op">]</span> <span class="op">+</span> <span class="va">update_term</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="co"># Update beta (difficulty) for each item</span></span>
<span>  <span class="va">beta_updated</span> <span class="op">&lt;-</span> <span class="va">diff</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">resp</span><span class="op">$</span><span class="va">item</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">resp_i</span> <span class="op">&lt;-</span> <span class="va">resp</span><span class="op">[</span><span class="va">resp</span><span class="op">$</span><span class="va">item</span> <span class="op">==</span> <span class="va">i</span>, <span class="op">]</span></span>
<span>    <span class="va">update_term</span> <span class="op">&lt;-</span> <span class="va">K_beta</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">E_Sij</span><span class="op">[</span><span class="va">resp</span><span class="op">$</span><span class="va">item</span> <span class="op">==</span> <span class="va">i</span><span class="op">]</span> <span class="op">-</span> <span class="va">resp_i</span><span class="op">$</span><span class="va">resp</span><span class="op">)</span></span>
<span>    <span class="va">beta_updated</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">diff</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="va">update_term</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    theta_est <span class="op">=</span> <span class="va">theta_updated</span>,</span>
<span>    diff_est <span class="op">=</span> <span class="va">beta_updated</span>,</span>
<span>    resp_cur <span class="op">=</span> <span class="va">resp</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Use with custom learning rates</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/meow.html">meow</a></span><span class="op">(</span></span>
<span>  select_fun <span class="op">=</span> <span class="va">select_max_info</span>,</span>
<span>  update_fun <span class="op">=</span> <span class="va">update_maths_garden_custom</span>,</span>
<span>  data_loader <span class="op">=</span> <span class="va">data_simple_1pl</span>,</span>
<span>  update_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>K_theta <span class="op">=</span> <span class="fl">0.05</span>, K_beta <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span>,</span>
<span>  data_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>N_persons <span class="op">=</span> <span class="fl">100</span>, N_items <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</section></section><section class="section level2"><h2 id="advantages-and-limitations">Advantages and Limitations<a class="anchor" aria-label="anchor" href="#advantages-and-limitations"></a>
</h2>
<section class="level2"><h3 id="advantages">Advantages<a class="anchor" aria-label="anchor" href="#advantages"></a>
</h3>
<ol type="1">
<li>
<strong>Simplicity</strong>: The algorithm is straightforward to implement and understand</li>
<li>
<strong>Real-time Updates</strong>: Both person and item parameters are updated simultaneously</li>
<li>
<strong>No Iteration Required</strong>: Updates are computed directly without iterative optimization</li>
<li>
<strong>Computational Efficiency</strong>: Fast computation suitable for real-time applications</li>
<li>
<strong>Interpretable</strong>: The update rules have clear intuitive meaning</li>
</ol></section><section class="level2"><h3 id="limitations">Limitations<a class="anchor" aria-label="anchor" href="#limitations"></a>
</h3>
<ol type="1">
<li>
<strong>Fixed Learning Rates</strong>: The algorithm uses constant learning rates that don’t adapt to data</li>
<li>
<strong>No Uncertainty Quantification</strong>: Doesn’t provide confidence intervals or standard errors</li>
<li>
<strong>Potential Instability</strong>: Large learning rates can cause parameter estimates to oscillate</li>
<li>
<strong>Assumes 1PL Model</strong>: Based on the Rasch model, may not fit data requiring 2PL or 3PL models</li>
<li>
<strong>No Prior Information</strong>: Doesn’t incorporate prior knowledge about parameters</li>
</ol></section></section><section class="section level2"><h2 id="extensions-and-modifications">Extensions and Modifications<a class="anchor" aria-label="anchor" href="#extensions-and-modifications"></a>
</h2>
<section class="level2"><h3 id="adaptive-learning-rates">Adaptive Learning Rates<a class="anchor" aria-label="anchor" href="#adaptive-learning-rates"></a>
</h3>
<p>You can implement adaptive learning rates that change based on the amount of data:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">update_maths_garden_adaptive</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">theta</span>, <span class="va">diff</span>, <span class="va">resp</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">E_Sij</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="va">theta</span><span class="op">[</span><span class="va">resp</span><span class="op">$</span><span class="va">id</span><span class="op">]</span> <span class="op">-</span> <span class="va">diff</span><span class="op">[</span><span class="va">resp</span><span class="op">$</span><span class="va">item</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Adaptive learning rates based on number of responses</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">resp</span><span class="op">$</span><span class="va">id</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">resp_j</span> <span class="op">&lt;-</span> <span class="va">resp</span><span class="op">[</span><span class="va">resp</span><span class="op">$</span><span class="va">id</span> <span class="op">==</span> <span class="va">j</span>, <span class="op">]</span></span>
<span>    <span class="va">n_responses</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">resp_j</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># Decrease learning rate with more responses</span></span>
<span>    <span class="va">K_theta_adaptive</span> <span class="op">&lt;-</span> <span class="fl">0.1</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">n_responses</span> <span class="op">*</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">update_term</span> <span class="op">&lt;-</span> <span class="va">K_theta_adaptive</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">resp_j</span><span class="op">$</span><span class="va">resp</span> <span class="op">-</span> <span class="va">E_Sij</span><span class="op">[</span><span class="va">resp</span><span class="op">$</span><span class="va">id</span> <span class="op">==</span> <span class="va">j</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">theta</span><span class="op">[</span><span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">theta</span><span class="op">[</span><span class="va">j</span><span class="op">]</span> <span class="op">+</span> <span class="va">update_term</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">resp</span><span class="op">$</span><span class="va">item</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">resp_i</span> <span class="op">&lt;-</span> <span class="va">resp</span><span class="op">[</span><span class="va">resp</span><span class="op">$</span><span class="va">item</span> <span class="op">==</span> <span class="va">i</span>, <span class="op">]</span></span>
<span>    <span class="va">n_responses</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">resp_i</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># Decrease learning rate with more responses</span></span>
<span>    <span class="va">K_beta_adaptive</span> <span class="op">&lt;-</span> <span class="fl">0.1</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">n_responses</span> <span class="op">*</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">update_term</span> <span class="op">&lt;-</span> <span class="va">K_beta_adaptive</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">E_Sij</span><span class="op">[</span><span class="va">resp</span><span class="op">$</span><span class="va">item</span> <span class="op">==</span> <span class="va">i</span><span class="op">]</span> <span class="op">-</span> <span class="va">resp_i</span><span class="op">$</span><span class="va">resp</span><span class="op">)</span></span>
<span>    <span class="va">diff</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">diff</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="va">update_term</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    theta_est <span class="op">=</span> <span class="va">theta</span>,</span>
<span>    diff_est <span class="op">=</span> <span class="va">diff</span>,</span>
<span>    resp_cur <span class="op">=</span> <span class="va">resp</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</section><section class="level2"><h3 id="constrained-updates">Constrained Updates<a class="anchor" aria-label="anchor" href="#constrained-updates"></a>
</h3>
<p>You can add constraints to prevent extreme parameter values:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">update_maths_garden_constrained</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">theta</span>, <span class="va">diff</span>, <span class="va">resp</span>, </span>
<span>                                          <span class="va">theta_bounds</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span>, <span class="fl">4</span><span class="op">)</span>, </span>
<span>                                          <span class="va">diff_bounds</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">E_Sij</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="va">theta</span><span class="op">[</span><span class="va">resp</span><span class="op">$</span><span class="va">id</span><span class="op">]</span> <span class="op">-</span> <span class="va">diff</span><span class="op">[</span><span class="va">resp</span><span class="op">$</span><span class="va">item</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Update theta with constraints</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">resp</span><span class="op">$</span><span class="va">id</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">resp_j</span> <span class="op">&lt;-</span> <span class="va">resp</span><span class="op">[</span><span class="va">resp</span><span class="op">$</span><span class="va">id</span> <span class="op">==</span> <span class="va">j</span>, <span class="op">]</span></span>
<span>    <span class="va">update_term</span> <span class="op">&lt;-</span> <span class="fl">0.1</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">resp_j</span><span class="op">$</span><span class="va">resp</span> <span class="op">-</span> <span class="va">E_Sij</span><span class="op">[</span><span class="va">resp</span><span class="op">$</span><span class="va">id</span> <span class="op">==</span> <span class="va">j</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">theta</span><span class="op">[</span><span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">theta</span><span class="op">[</span><span class="va">j</span><span class="op">]</span> <span class="op">+</span> <span class="va">update_term</span></span>
<span>    </span>
<span>    <span class="co"># Apply constraints</span></span>
<span>    <span class="va">theta</span><span class="op">[</span><span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">theta_bounds</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">theta_bounds</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="va">theta</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="co"># Update diff with constraints</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">resp</span><span class="op">$</span><span class="va">item</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">resp_i</span> <span class="op">&lt;-</span> <span class="va">resp</span><span class="op">[</span><span class="va">resp</span><span class="op">$</span><span class="va">item</span> <span class="op">==</span> <span class="va">i</span>, <span class="op">]</span></span>
<span>    <span class="va">update_term</span> <span class="op">&lt;-</span> <span class="fl">0.1</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">E_Sij</span><span class="op">[</span><span class="va">resp</span><span class="op">$</span><span class="va">item</span> <span class="op">==</span> <span class="va">i</span><span class="op">]</span> <span class="op">-</span> <span class="va">resp_i</span><span class="op">$</span><span class="va">resp</span><span class="op">)</span></span>
<span>    <span class="va">diff</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">diff</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="va">update_term</span></span>
<span>    </span>
<span>    <span class="co"># Apply constraints</span></span>
<span>    <span class="va">diff</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">diff_bounds</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">diff_bounds</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="va">diff</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    theta_est <span class="op">=</span> <span class="va">theta</span>,</span>
<span>    diff_est <span class="op">=</span> <span class="va">diff</span>,</span>
<span>    resp_cur <span class="op">=</span> <span class="va">resp</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</section></section><section class="section level2"><h2 id="best-practices">Best Practices<a class="anchor" aria-label="anchor" href="#best-practices"></a>
</h2>
<ol type="1">
<li>
<strong>Start with Small Learning Rates</strong>: Begin with <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mi>θ</mi></msub><mo>=</mo><msub><mi>K</mi><mi>b</mi></msub><mo>=</mo><mn>0.1</mn></mrow><annotation encoding="application/x-tex">K_\theta = K_b = 0.1</annotation></semantics></math> and adjust based on results</li>
<li>
<strong>Monitor Convergence</strong>: Check if parameter estimates stabilize over iterations</li>
<li>
<strong>Use Constraints</strong>: Implement bounds on parameter values to prevent extreme estimates</li>
<li>
<strong>Consider Adaptive Rates</strong>: Use decreasing learning rates for more stable long-term estimates</li>
<li>
<strong>Validate Results</strong>: Compare with other estimation methods when possible</li>
<li>
<strong>Test with Different Data</strong>: Ensure the algorithm works well with your specific data characteristics</li>
</ol></section><section class="section level2"><h2 id="example-complete-workflow">Example: Complete Workflow<a class="anchor" aria-label="anchor" href="#example-complete-workflow"></a>
</h2>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load required packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://klintkanopka.com/meow/">meow</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define custom Maths Garden function with adaptive rates</span></span>
<span><span class="va">update_maths_garden_improved</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">theta</span>, <span class="va">diff</span>, <span class="va">resp</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">E_Sij</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="va">theta</span><span class="op">[</span><span class="va">resp</span><span class="op">$</span><span class="va">id</span><span class="op">]</span> <span class="op">-</span> <span class="va">diff</span><span class="op">[</span><span class="va">resp</span><span class="op">$</span><span class="va">item</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Adaptive learning rates</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">resp</span><span class="op">$</span><span class="va">id</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">resp_j</span> <span class="op">&lt;-</span> <span class="va">resp</span><span class="op">[</span><span class="va">resp</span><span class="op">$</span><span class="va">id</span> <span class="op">==</span> <span class="va">j</span>, <span class="op">]</span></span>
<span>    <span class="va">n_responses</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">resp_j</span><span class="op">)</span></span>
<span>    <span class="va">K_theta_adaptive</span> <span class="op">&lt;-</span> <span class="fl">0.1</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">n_responses</span> <span class="op">*</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">update_term</span> <span class="op">&lt;-</span> <span class="va">K_theta_adaptive</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">resp_j</span><span class="op">$</span><span class="va">resp</span> <span class="op">-</span> <span class="va">E_Sij</span><span class="op">[</span><span class="va">resp</span><span class="op">$</span><span class="va">id</span> <span class="op">==</span> <span class="va">j</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">theta</span><span class="op">[</span><span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">theta</span><span class="op">[</span><span class="va">j</span><span class="op">]</span> <span class="op">+</span> <span class="va">update_term</span></span>
<span>    <span class="va">theta</span><span class="op">[</span><span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="fl">4</span>, <span class="va">theta</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>  <span class="co"># Constraints</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">resp</span><span class="op">$</span><span class="va">item</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">resp_i</span> <span class="op">&lt;-</span> <span class="va">resp</span><span class="op">[</span><span class="va">resp</span><span class="op">$</span><span class="va">item</span> <span class="op">==</span> <span class="va">i</span>, <span class="op">]</span></span>
<span>    <span class="va">n_responses</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">resp_i</span><span class="op">)</span></span>
<span>    <span class="va">K_beta_adaptive</span> <span class="op">&lt;-</span> <span class="fl">0.1</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">n_responses</span> <span class="op">*</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">update_term</span> <span class="op">&lt;-</span> <span class="va">K_beta_adaptive</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">E_Sij</span><span class="op">[</span><span class="va">resp</span><span class="op">$</span><span class="va">item</span> <span class="op">==</span> <span class="va">i</span><span class="op">]</span> <span class="op">-</span> <span class="va">resp_i</span><span class="op">$</span><span class="va">resp</span><span class="op">)</span></span>
<span>    <span class="va">diff</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">diff</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="va">update_term</span></span>
<span>    <span class="va">diff</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="fl">4</span>, <span class="va">diff</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>  <span class="co"># Constraints</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    theta_est <span class="op">=</span> <span class="va">theta</span>,</span>
<span>    diff_est <span class="op">=</span> <span class="va">diff</span>,</span>
<span>    resp_cur <span class="op">=</span> <span class="va">resp</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Run simulation</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/meow.html">meow</a></span><span class="op">(</span></span>
<span>  select_fun <span class="op">=</span> <span class="va">select_max_info</span>,</span>
<span>  update_fun <span class="op">=</span> <span class="va">update_maths_garden_improved</span>,</span>
<span>  data_loader <span class="op">=</span> <span class="va">data_simple_1pl</span>,</span>
<span>  data_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>N_persons <span class="op">=</span> <span class="fl">100</span>, N_items <span class="op">=</span> <span class="fl">50</span>, data_seed <span class="op">=</span> <span class="fl">123</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Analyze results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">results</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</section><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config);
    }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script></main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Klint Kanopka, Sophia Deng.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
